var Twitter=function(t){var e,n,r={},o="https://oauth.truthy.indiana.edu",i=o+"/api",s="oauth_twitter_token",u="oauth_twitter_provider";function a(t){return n||(n=new Promise(function(e,n){return t.get("/1.1/account/verify_credentials.json",{data:{include_email:!1,include_entities:!1,skip_status:!0}}).then(function(t){e(t)},function(t){n(t)})})),n}function c(t){return new Promise(function(n,r){token=!t&&function(){if(!e){var t=JSON.parse(localStorage.getItem(s)),n=JSON.parse(localStorage.getItem(u));if(t&&n)try{e=OAuth.create("twitter",t,n)}catch(t){console.warn(t),localStorage.removeItem(s,u)}}return e}(),token?a(token).then(function(t){n(token)},function(){return c(!0)}):OAuth.popup("twitter").done(function(t){var r;e=r=t,axios.get(i+"/providers/twitter?extend=true").then(function(t){localStorage.setItem(s,JSON.stringify(r)),localStorage.setItem(u,JSON.stringify(t))},function(t){console.debug(t)}),n(t),a(t)}).fail(function(t){r(t)})})}function f(t,e,n,r){return new Promise(function(o,i){t=t.toLowerCase(),c().then(function(s){s[t](e,{data:n}).done(function(t){o(t)}).fail(function(t){i({error:t,message:r})})},function(t){i({error:t})})})}OAuth.initialize(t),OAuth.setOAuthdURL(o);var l={},h={};function w(t,e,n){return new Promise(function(r,o){var i,s=(t.startsWith("follower")?l:h)[e],u={screen_name:e,count:n,cursor:s,skip_status:!0};if(t.startsWith("follower"))i="/1.1/followers/list.json";else{if(!t.startsWith("friend")&&!t.startsWith("following"))throw'relationship type must be "followers" or "friends"';i="/1.1/friends/list.json"}f("GET",i,u,"Twitter was unable to retrieve followers of this user. Is there a typo?").then(function(t){l[e]=t.next_cursor,r(t.users)})})}return r.getUserMentions=function(t){return f("GET","/1.1/search/tweets.json",{q:"@"+t,count:100},"Twitter was unable to retrieve mentions of this user, is there a typo?")},r.getUserDataById=function(t){return f("GET","/1.1/users/show.json",{user_id:t},"Twitter was unable to retrieve information for this user, is there a typo?")},r.getUserTimelineById=function(t){return f("GET","/1.1/statuses/user_timeline.json",{user_id:t,count:200},"Twitter was unable to retrieve a timeline for this user, is there a typo?")},r.getFollowers=function(t,e){return w("followers",t,e)},r.getFollowing=function(t,e){return w("friends",t,e)},r.getUserLanguage=function(t){return f("GET","/1.1/search/tweets.json",t)},r.getTweets=function(t,e,n,r){return f("GET","/1.1/search/tweets.json",{q:t,lang:e,max_id:n,result_type:r,count:100,include_entities:1},"Twitter was unable to retrieve mentions of this user, is there a typo?")},r.blockUser=function(t){return f("POST","/1.1/blocks/create.json",{user_id:t,include_entities:!1,skip_status:!0})},r.unblockUser=function(t){return f("POST","/1.1/blocks/destroy.json",{user_id:t,include_entities:!1,skip_status:!0})},r.followUser=function(t){return f("POST","/1.1/friendships/create.json",{user_id:t})},r.unfollowUser=function(t){return f("POST","/1.1/friendships/destroy.json",{user_id:t})},r.me=function(){return n},r.verifyMe=function(){return new Promise(function(t,e){c().then(function(n){a(n).then(t,e)},e)})},r.logOut=function(){e=void 0,n=void 0,localStorage.removeItem(s)},r};